/* File: exploit.h
 * Auth: isinstance
 * Date: 20171031
 * Mail: no
 */

#ifndef EXPLOIT_H
#define EXPLOIT_H

#define POST_MODEL "user=%s&password=%s&Submit=登+陆"
//#define POST_MODEL "user=%s&password=%s&Submit=E799BB+E99986"
//#define POST_MODEL "user=%s&password=%s&Submit=%E7%99%BB+%E9%99%86"
#define BUFFER_SIZE 1024

#define RAND_USER_NAME_DEFAULT 0
#define ATTACK_MODE_DEFAULT 0
#define DEBUG_MODE_DEFAULT 0

#define MAX_LOOP_NUM 1024
#define MAX_PROCESS_NUM 4
#define MAX_THREAD_NUM 1
// For test
//#define MAX_PROCESS_NUM 1
//#define MAX_THREAD_NUM 1

// Use the same socket to send message
// Used in http_post and with the -n option
#define MAX_SEND_TIME 10240

#define POST_URL "http://192.168.20.1:80/login.cgi"
#define PASSWD_FILE_PATH "~/SPASSWD-%s.txt"
#define USAGE "     Usage: ./length\n"                                                    \
              "          : ./length -r -d\n"                                              \
              "          -r   Use the random user name(default use admin as user name)\n" \
              "          -d   Debug mod\n"                                                \
              "          -D   Nonsense debug mode\n"                                      \
              "          -t   Attack mod(this mod will not guess the correct password)\n"

struct INPUT_ARG
{
    int RandFlag;
    int DebugMode;
    int ThreadSeed;
    int Attack;
};

struct PARSE_RETURN
{
    int toption;
    int roption;
    int doption;
};
struct UNLIMITED_INPUT
{
    int RandFlag;
    int DebugMode;
    int ThreadSeed;
    int Attack;
};

void *exploit(const struct INPUT_ARG *input);

#endif